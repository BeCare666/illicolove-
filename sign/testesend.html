<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Envoyer une photo à Firebase</title>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-app.js"></script>
<!-- Add Firebase products that you want to use -->
<script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-firestore.js"></script>
  </head>
  <body>
    <h1>Envoyer une photo à Firebase</h1>
    <input type="file" id="input-file">

    <script>
      // Configurer l'objet de configuration Firebase avec les clés d'API et autres informations de configuration
      var firebaseConfig = {
        apiKey: "AIzaSyBoOxLmlH9WR7si2Y0R01OM3c5I1wgnuPM",
          authDomain: "illicolove-7c904.firebaseapp.com",
          databaseURL: "https://illicolove-7c904-default-rtdb.firebaseio.com",
          projectId: "illicolove-7c904",
          storageBucket: "illicolove-7c904.appspot.com",
          messagingSenderId: "1086957054874",
          appId: "1:1086957054874:web:4f1899c85184210e482823"
      };

      // Initialiser Firebase avec la configuration
      firebase.initializeApp(firebaseConfig);

      // Récupérer une référence à la base de données
      var database = firebase.database();

      // Sélectionnez l'élément HTML de l'input file qui permet à l'utilisateur de sélectionner une photo
      var inputElement = document.getElementById("input-file");

      // Ajoutez un gestionnaire d'événements pour écouter le changement de fichier
      inputElement.addEventListener("change", handleFiles, false);

   function handleFiles() {
  // Récupérez le fichier sélectionné par l'utilisateur
  var file = this.files[0];
  console.log("Fichier sélectionné : ", file);

  // Créez une nouvelle instance de FileReader
  var reader = new FileReader();

  // Ajoutez un gestionnaire d'événements pour écouter la fin de la lecture du fichier
  reader.onload = function(event) {
    // Récupérez le contenu du fichier sous forme de tableau d'octets
    var fileContent = new Uint8Array(event.target.result);
    console.log("Contenu du fichier : ", fileContent);

    // Convertissez le tableau d'octets en une chaîne de caractères codée en base64
    var base64Content = btoa(String.fromCharCode.apply(null, fileContent));
    console.log("Contenu en base64 : ", base64Content);

    // Stockez la chaîne de caractères base64 dans votre base de données
    firebase.firestore().collection("utilisateurs").doc("utilisateur1").set({
      nom: "Doe",
      prenom: "John",
      photo: base64Content
    }).then(function() {
      console.log("Données utilisateur enregistrées avec succès.");
    }).catch(function(error) {
      console.error("Erreur lors de l'enregistrement des données utilisateur : ", error);
    });
  };

  // Commencez la lecture du fichier
  reader.readAsArrayBuffer(file);
}

    </script>

  </body>
</html>
